=== Wordfence Security ===
Contributors: mmaunder 
Tags: wordpress, security, wordpress security, security plugin, secure, anti-virus, malware, firewall, antivirus, virus, google safe browsing, phishing, scrapers, hacking, wordfence, securty, secrity, secure
Requires at least: 3.3.1
Tested up to: 3.5.1
Stable tag: 3.7.2

Wordfence Security is a free enterprise class security plugin that includes a firewall, virus scanning, real-time traffic with geolocation and more. 

== Description ==

Wordfence Security is a free enterprise class security plugin that includes a firewall, anti-virus scanning, malicious URL scanning and live traffic including crawlers. Wordfence is the only WordPress security plugin that can verify and repair your core, theme and plugin files, even if you don't have backups.

Wordfence is now Multi-Site compatible. 

[Remember to visit our support forums if you have questions or comments.](http://wordfence.com/forums/)

Wordfence is 100% free. We also offer a Premium API key that lets you block countries and schedule scans for specific times.

Wordfence:

* Scans core files, themes and plugins against WordPress.org repository versions to check their integrity.
* Includes a firewall to block common security threats like fake Googlebots, malicious scans from hackers and botnets.
* Includes advanced IP and Domain WHOIS to report malicious IP's or networks and block entire networks using the firewall.
* See how files have changed. Optionally repair changed files that are security threats.
* Scans for signatures of over 44,000 known malware variants that are known security threats.
* Scans for many known backdoors including C99, R57, RootShell, Crystal Shell, Matamu, Cybershell, W4cking, Sniper, Predator, Jackal, Phantasma, GFS, Dive, Dx and many many more.
* Continuously scans for malware and phishing URL's including all URL's on the Google Safe Browsing List in all your comments, posts and files that are security threats.
* Scans for heuristics of backdoors, trojans,  suspicious code and other security issues.
* Checks the strength of all user and admin passwords to enhance login security.
* Monitor your DNS security for unauthorized DNS changes.
* Rate limit or block security threats like aggressive crawlers, scrapers and bots doing security scans for vulnerabilities in your site.
* Choose whether you want to block or throttle users and robots who break your security rules.
* Includes login security to lock out brute force hacks and to stop WordPress from revealing info that will compromise security.
* See all your traffic in real-time, including robots, humans, 404 errors, logins and logouts and who is consuming most of your content. Enhances your situational awareness of which security threats your site is facing.
* A real-time view of all traffic including automated bots that often constitute security threats that Javascript analytics packages never show you.
* Real-time traffic includes reverse DNS and city-level geolocation. Know which geographic area security threats originate from.
* Monitors disk space which is related to security because many DDoS attacks attempt to consume all disk space to create denial of service.
* Wordfence Security for multi-site also scans all posts and comments across all blogs from one admin panel.
* WordPress Multi-Site (or WordPress MU in the older parlance) compatible.
* Premium users can also block countries and schedule scans for specific times and a higher frequency.
* Our online forums are available 24/7 to answer your WordPress security questions. 

Wordfence Security is full-featured and constantly updated by our team to incorporate the latest security features and to hunt for the 
newest security threats to your WordPress website.

== Installation ==

To install Wordfence Security and start protecting your WordPress website:

[Remember to visit our support forums if you have questions or comments.](http://wordfence.com/forums/)

1. Install Wordfence Security automatically or by uploading the ZIP file. 
1. Activate the security plugin through the 'Plugins' menu in WordPress.
1. Wordfence is now activated. Go to the scan menu and start your first security scan. Scheduled security scanning will also be enabled.
1. Once your first scan has completed a list of security threats will appear. Go through them one by one to secure your site.
1. Visit the Wordfence options page to enter your email address so that you can receive email security alerts.
1. Optionally change your security level or adjust the advanced options to set individual security scanning and protection options for your site.
1. Click the "Live Traffic" menu option to watch your site activity in real-time. Situational awareness is an important part of website security.

To install Wordfence on WordPress Multi-Site installations (support is currently in Beta):

1. Install Wordfence Security via the plugin directory or by uploading the ZIP file.
1. Network Activate Wordfence Security. This step is important because until you network activate it, your sites will see the plugin option on their plugins menu. Once activated that option dissapears. 
1. Now that Wordfence is network activated it will appear on your Network Admin menu. Wordfence will not appear on any individual site's menu. 
1. Go to the "Scan" menu and start your first security scan. 
1. Wordfence will do a security scan all files in your WordPress installation including those in the blogs.dir directory of your individual sites. 
1. Live Traffic will appear for ALL sites in your network. If you have a heavily trafficked system you may want to disable live traffic which will stop logging to the DB. 
1. Firewall rules and login rules apply to the WHOLE system. So if you fail a login on site1.example.com and site2.example.com it counts as 2 failures. Crawler traffic is counted between blogs, so if you hit three sites in the network, all the hits are totalled and that counts as the rate you're accessing the system.

== Frequently Asked Questions ==

[Remember to visit our support forums if you have questions or comments.](http://wordfence.com/forums/)

= What does Wordfence Security do that other WordPress security plugins don't do? =

* Wordfence security scans check all your files, comments and posts for URL's in Google's Safe Browsing list.
* All Wordfence security scans happen hourly instead of daily or even less frequently.
* Wordfence scans do not consume large amounts of your precious bandwidth because all scans happen on your web server which makes them very fast.
* Wordfence fully supports WordPress Multi-Site which means you can security scan every blog in your Multi-Site installation with one click.
* Wordfence checks the integrity of your WordPress core files, plugins and themes against the original files in the WordPress repository. We alert you to any changes which may be a security threat, let you see what has changed and you can even repair changed files.

= Does Wordfence support Multi-Site installations? =

Yes. WordPress MU or Multi-Site as it's called now is fully supported. Using Wordfence you can security scan every blog in your network with one click. If one of your customers posts a page or post with a known malware URL that threatens your whole domain with being blacklisted by Google, we will tell you within a maximum of one hour which is how often scans occur. 

= Will Wordfence slow my site down? =

We have spent a lot of time making sure Wordfence runs very quickly and securely. Wordfence uses its own database
tables and advanced mysql features to ensure it runs as fast as possible. The creators of Wordfence
also run Feedjit, a large scale real-time analytics product and ad network and much of the technology and knowledge from
our real-time analytics products is built into Wordfence.

= How often is Wordfence updated? =

The Wordfence security plugin is frequently updated and we update the code on our security scanning servers
more frequently. Our cloud servers are continually updated with the latest known security threats and vulnerabilities so
that we can blog any security threat as soon as it emerges in the wild.

= What if I need support? =

All our paid customers receive priority support. Excellent customer service is a key part
of being a Wordfence member. You can also [visit our support forums where we provide free support for all Wordfence users](http://wordfence.com/forums/) and answer any security releated questions you may have.

= Can I disable certain security features of Wordfence? =

Yes! Simply visit the Options page, click on advanced options and enable or disable the security features you want.

= What if my site security has already been compromised by a hacker? =

Wordfence is the only security plugin that is able to repair core files, themes and plugins on sites where security is already compromised.
However, please note that site security can not be assured unless you do a full reinstall if your site has been hacked. We recommend you only
use Wordfence to get your site into a running state in order to recover the data you need to do a full reinstall. A full reinstall is the only
way to ensure site security once you have been hacked. 

= How will I be alerted that my site has a security problem? =

Wordfence sends security alerts via email. Once you install Wordfence, you will configure a list of email addresses where security alerts will be sent.
When you receive a security alert, make sure you deal with it promptly to ensure your site stays secure.

= My WordPress site is behind a firewall. Doesn't that make it secure? =

If your site is accessible from the web, it means that people you don't know can execute PHP code on your site.
They have to be able to execute PHP code, like the core WordPress code, in order for your site to work. 
Most WordPress security threats allow a hacker to execute PHP code on your website. The challenge hackers
face is how to get their malicious PHP code onto your site to compromise your security. There
are many upload mechanisms that WordPress itself, themes and plugins offer and the vast majority of these
are secure. However, every now and then a hacker discovers an upload mechanism that is not secure or 
a way of fooling your site into allowing an upload. That is usually when security is compromised. Even
though your site is behind a commercial firewall, it still accepts web requests that include uploads and executes PHP code
and as long as it does that, it may become face a security vulnerability at some point.

= Will Wordfence protect me against the Timthumb security problem? =

The timthumb security exploit occurred in 2011 and all good plugins and themes now use an updated 
version of timthumb (which the creator of Wordfence wrote and donated to the timthumb author) which closes the security hole that
caused the problem. However we do scan for old version of timthumb for good measure to make sure they don't 
cause a security hole on your site. 

= People keep telling me that WordPress itself has security problems. Is that true? =

In general, no it's not. The WordPress team work very hard to keep the awesome software they have produced secure and in the
rare cases when a security hole is found, they fix it very quickly. Most responsible plugin authors also fix security holes
as soon as they are told about them. That's why Wordfence will warn you if you're running an old version of WordPress, a plugin
or a theme, because often these have been updated to fix a security hole.


== Screenshots ==

1. The home screen of Wordfence where you can see a summary, manage security issues and do a manual security scan. 
2. The Live Traffic view of Wordfence where you can see real-time activity on your site.
3. The "Blocked IPs" page where you can manage blocked IP's, locked out IP's and see recently throttled IPs that violated security rules.
4. The basic view of Wordfence options. There is very little to configure other than your alert email address and security level.
5. If you're technically minded, this is the under-the-hood view of Wordfence options where you can fine-tune your security settings.

== Changelog ==

= 3.7.2 =
* Fixed issue that caused locked out IP's to not appear, or to appear with incorrect "locked out until" time. 

= 3.7.1 =
* Moved global firewall, login security and live traffic options to top of options page.
* Made it clear that if you have firewall disabled, IP's won't be blocked, country blocking won't work and advanced blocking won't work with warnings on each page.

= 3.6.9 =
* Fixed JS error that occurs occasionally when users are viewing activity log in real-time.
* New Feature: Prevent users registering 'admin' username if it doesn't exist. Recommended if you've deleted 'admin'. Enable on 'options' page. 
* Check if GeoIP library is already declared for all functions. Fixes Fatal error: Cannot redeclare geoip_country_code_by_name.
* Fixed a compatibility issue with sites and hosts using Varnish front-end cache to ensure legit users don't get blocked. Added two HTTP no-cache and Expires headers.
* Fixed bug when using Advanced User-Agent blocking with certain patterns this would appear: Warning: preg_match() [function.preg-match]: Unknown modifier
* Vastly improved speed of Advanced User-Agent blocking. No longer using regex but still support wildcards using fnmatch()
* We now support usernames with spaces in the list of users to ignore in the live traffic config on 'options' page.
* Improved language in status messages to avoid confusion. Changed "unrecognized files" to "additional files" to describe non-core/theme/plugin files.

= 3.6.8 =
* Fixed bug that caused IP range blocking to not block.
* Fixed bug that caused unblocking a permanently blocked IP to work, but not refresh the list. 
* Added usernames to the email you receive when a user is locked out.
* Added a few more status messages for URL malware scanning.
* Removed the sockets function call from connection testing because some hosts don't allow calls to socket_create()
* Added detection in the Whois page to check if the server has the fsockopen() function available with helpful message if it's disabled. 
* Whitelisted IP's now override country blocking and range blocking.
* Removed Bluehost affiliate links for free customers
* Fixed issue that caused scans to crash when checking URLs for malware.
* Fixed issue that caused scans with large numbers of posts that contain the same URL to crash.
* Updated the GeoIP database for country blocking to newest version.

= 3.6.7 =
* Improved security for Cloudflare customers to prevent spoofing attacks and protect when a hacker bypasses Cloudflare proxies.
* Added clear explanation of what increasing AJAX polling time does on options page.
* Fixed issue with Wordfence detecting itself as malware. We messed up the version number in previous release. 

= 3.6.6 =
* Added option to change AJAX polling frequency
* Fixed issue that caused whitelisted IP's to not be whitelisted. 
* Added code that prevents blocking of Wordfence's API server (or Wordfence will cease to function)
* Added link at bottom of 'options' page to test connectivity to our API servers.
* Include any CURL error numbers in error reporting.
* Fixed issue that caused IP range blocking to not block access to login page.
* Fixed issue that caused cache files to be flagged as malicious.

= 3.6.5 =
* Fixed Fatal error: func_get_args(): Can't be used as a function parameter.
* This bug affected users using PHP older than 5.3.0

= 3.6.4 =
* Fixed a major javascript bug that snuck in 2 releases ago and has disabled many features for Internet Explorer browsers. 
* Clarified range blocking examples.

= 3.6.3 =
* Fixed 'max_user_connections' issue. 
* Wordfence now uses WordPress's WPDB and this halves the number of DB connections Wordfence establishes to your DB.
* Wordfence is now HyperDB compatible.
* Advanced blocking i.e. Browser and IP Range blocking is now a free feature.
* We no longer disable Live Traffic if we detect a caching plugin. Based on user feedback, apparently live traffic actually works with those plugins.
* Fixed issue that causes site to crash if a conflicting GeoIP library is installed.
* Changed logHuman routine to do a LOW_PRIORITY MySQL update to speed things up.
* Login failure counter is now reset if you send yourself an unlock email so you're not locked out again after 1 failure. 
* The free version of Wordfence is now supported with ads at the top of the admin pages. Please visit our sponsors and help keep Wordfence free!
* Fixed issue that may cause scans to not be scheduled using the default schedule for new users.
* There was no 3.6.2 release, in case you're wondering about the version skip.

= 3.6.1 =
* Major new release that includes the much asked for IP Range blocking with ISP blocking ability and browser blocking. 
* Added feature: WHOIS for IP's and Domains. Supports all registries and local rWhois
* Added feature: Advanced Blocking to block IP ranges and browser patterns.
* Added feature: WHOIS on live traffic pages.
* Added feature: network blocking links on live traffic pages. 
* Fixed bug where W3 Total Cache and WP Super Cache cache blocked pages.
* Added explanation of how caching affects live traffic logging if we detect a caching plugin.
* Fixed AJAX loading to deal with multiple parallel ajax requests. 
* Updated tour to include info on new WHOIS and Advanced Blocking features.
* Changed manual IP blocks to be permanent by default.
* Fixed issue that caused live traffic page not to reload when IP is unblocked.
* Modified "How does your site get IP's" config to avoid confusing new users.
* Changed 503 block message to be more helpful with link to FAQ on how to unblock.
* Removed redundant code in wfAPI.php
* Optimized code by moving firewall specific code to execute only if firewall is enabled.
* Fixed issue that caused "last attempted access" to show over 500 months ago.
* Fixed issue that was causing warning in getIP() code.
* Upgraded to Wordfence API version 2.6.

= 3.5.3 =
* This is the dev version. Stable is 3.5.2.
* Added detection for "hacked by badi" hack. Check if wp_options has been changed to UTF-7.

= 3.5.2 =
* IP detection is now much more robust. Admins must specify how their site gets IP addresses.
* Fixed issue that would throw Ajax ticker into a hard loop and put load on a server if user is on "options" page and WF can't detect IPs.
* Added support for Cloudflare proxies when getting client's real IP address.
* If we fail to get an IP and then get an IP succesfully, we update the activity log.
* Activity log update in case of successful IP acquisition will warn if we're getting internal RFC1918 IP's e.g. the IP of your firewall.

= 3.5.1 =
* Fixed issue with twentyten, twentyeleven, twentytwelve themes showing up as modified in 3.5.
* Fixed issue with wpdb->prepare throwing warnings. WordPress changed their code and we have now caught up.
* Fixed issue of files containing "silence is golden" showing up as being changed with no executable content. 

= 3.4.5 =
* Fixed security issue of being able to list wordfence's own virtual dir on some server configurations.
* Fixed issue of WF using deprecated function which caused warnings or errors on install.
* Added link to security alert mailing list on "Scan" page next to manual start scan button and in tour.

= 3.4.4 =
* Fixed issue that caused scans to not complete.
* Fixed issue that caused scans to launch a large number of child processes due to very short scan timeout.
* Fixed issue that caused websites that don't know their own hostname to not be able to scan.
* Added workaround for a bug in Better WP Security breaking Wordfence due to their code overwriting the WP version.
* Optimized the way we calculate max execution time for each process while scanning.

= 3.4.1 =
* Removed wfscan.php script and now using pseudo-ajax calls to fire off scans. Much more reliable.
* Removed visitor.php script and now using pseudo-ajax calls to log human visits.
* Added config option to allow admin to specify max execution time (advanced only!!).
* Fixed issue that caused API calls to fail on MultiSite installs.
* Fixed issue that caused comments to break on MultiSite installs under certain conditions.
* Fixed issue that caused incorrect domain to be shown in live traffic view on multi-site installs.
* Fixed issue where some proxies/firewalls send space delimited IP addresses in HTTP headers and Wordfence now handles that.
* Fixed issue that caused Wordfence to capture activation errors of other plugins. 
* Geo IP database update to November 7th edition.

= 3.3.7 =
* Upgrade immediately. Fixes possible XSS vulnerability in Wordfence "firewall unlock" form.
* Also added rate limiting to max of 10 requests per second to the unlock form.

= 3.3.5 =
* Re-releasing to try and fix an issue with the WordPress plugin distro system.

= 3.3.4 =
* Fixed bug that caused malformed URLs to be sent to scanning server which caused errors on some installations.
* Fixed issue that caused scans to "hang" or stall on larger sites during "Analyzing" phase when we hash files. Sites of arbitrary size can now be scanned.
* Fixed issue that caused "plugin generated X characters of unexpected output" error during install or upgrade.

= 3.3.3 =
* Fixed errors caused by ini_set being disabled on certain servers.
* Removed error logging messages in certain cases because some badly configured hosts write these errors to the web browser.
* Fixed getIP code that was evaluating arrays as strings in some cases.
* Added error logging so that if there is an activation error, the Wordfence will display the actual error to you.
* Fixed issue that caused scan to output "Could not get the administrator's user ID." when a user has changed their table prefixes under certain conditions.

= 3.3.2 =
* A complete rearchitecture of Wordfence scanning to massively improve performance.
* Our free customers are now 100% back in business. Apologies for the delay, but this was worth the wait.
* Wordfence is now 4X faster for both free and paid customers.
* Significantly reduced CPU and memory overhead.
* Significantly reduced network througput when communicating with Wordfence scanning servers.
* Big performance improvement on our own scanning servers which allows us to continue to provide Wordfence free for the forseeable future.
* Upgraded scanning API to version 2.4
* Upgraded Geo IP database to October version.
* Moved core, theme, plugin and malware scanning into hashing recursive routine for big performance gain.
* Removed need for fileQ in hashing routine for reduction in memory usage and reduction in DB write size.
* Removed send-packet architecture and now processing files locally by fetching comparison data from scanning server instead.
* Removed wfModTracker - old module that is no longer used.
* Malware is now scanned by fetching hash prefixes from WF server instead of sending hashes of every file to our server. Much more efficient.
* Made status messages in summary console a little more user friendly.

= 3.2.7 =
* Fixed dates and times in activity log alert emails and other emails to be in site's local timezone.
* Added advanced country blocking options which allow bypass if a special URL is hit.
* Added warning in options page if alert email is not configured under alert checkboxes.
* Modified scan times to be within 60 minute window after scheduled time to prevent stampede at the top of the hour on our scanning server.
* Fixed bug on Godaddy and a few other hosts where viewing list of files not in the repo caused error. This was caused by posix functions not being supported on Godaddy and some other hosts. 

= 3.2.6 =
* Paid feature: Remote site vulnerability and infection scanning.

= 3.2.5 =
* Moved all attack signatures out of the plugin to prevent Wordfence being detected as malicious in a false positive.

= 3.2.4 =
* Improved country blocking to make bulk adding/deleting of countries much easier.
* Fixed bug that caused Google feed fetcher and other Google UA bots to get blocked if blocking of unverified Googlebots was enabled.
* Fixed issue where Locked out users were shown having the same expiry time as Blocked IP's.
* Fixed issue where Locked out users were not shown in the locked out list, but were still locked out if Blocked IP and Locked out expiry was different.
* Improved performance of whitelisting so if whitelisted, all rules are bypassed.
* Fixed issue that caused twentyten and twentyeleven themes to be shown as missing core files if they have been removed and theme scanning is enabled.
* Fixed issue that made it impossible to end the tour for Firefox users.

= 3.2.1 =
* Theme and plugin scanning is now free. Woohoo!
* Added introductory tour for Wordfence.
* Upgraded to Wordfence scanning API version 2.0 to allow free theme and plugin scanning.
* Fixed two issue with scheduled scanning for premium users that would cause scans to not run or run at wrong times under certain conditions.
* Added feature to view unknown files on system to help clean badly infected systems. See on scanning page in "Tools" under yellow box.
* Fixed blocked countries overflowing their container in the user interface. 
* Fixed case where if user is using MySQL >= 5.1.16 and doesn't have the "drop" privilege, they can't truncate the wfFileQueue table and it could grow uncontrollably.
* Updated to the new Libyan flag.
* Fixed mysql_ping() reconnection to DB generating warnings.
* Fixed issue that caused scans to hang. Wordfence now processes smaller batches of files before checking if it needs to fork.
* Security scan for backdoors: "s72 Shell",  "r57 kartal",  "r57shell",  "rootshell",  "r57",  "r57 Mohajer22",  "r57 iFX",  "php backdoor",  "phpRemoteView"
* Security scan for backdoors: "nstview",  "nshell",  "mysql tool",  "nsTView",  "matamu",  "mysql shell",  "load shell",  "ironshell",  "lamashell",  "hiddens shell"
* Security scan for backdoors: "h4ntu shell",  "go shell",  "dC3 Shell",  "gfs sh",  "cybershell",  "c99 w4cking",  "ctt sh"
* Security scan for backdoors: "c99 madnet",  "c99 locus7s",  "c99 PSych0",  "c99",  "c0derz shell",  "accept language",  "Web shell"
* Security scan for backdoors: "aZRaiLPhp",  "SnIpEr SA Shell",  "Safe0ver Shell"
* Security scan for backdoors: "SimShell",  "Rootshell",  "Predator",  "PhpSpy",  "PHPJackal",  "PHANTASMA",  "PHP Shell"
* Security scan for backdoors: "NTDaddy",  "NetworkFileManagerPHP",  "NIX REMOTE WEB SHELL",  "NGH"
* Security scan for backdoors: "NFM",  "Mysql interface",  "NCC Shell",  "MySQL Web Interface",  "MyShell",  "Macker PHPShell"
* Security scan for backdoors: "Loaderz WEB Shell",  "KA uShell",  "KAdot Universal Shell",  "Liz0ziM"
* Security scan for backdoors: "Gamma Web Shell",  "JspWebshell",  "GRP WebShell",  "GFS web shell"
* Security scan for backdoors: "GFS Web Shell",  "Dx",  "DxShell,  "Dive Shell",  "DTool Pro"
* Security scan for backdoors: "Ajax PHP Command Shell",  "Antichat Shell",  "Ayyildiz Shell"
* Security scan for backdoors: "C99 Shell", "C99 madShell",  "CTT Shell",  "CasuS",  "CmdAsp",  "Crystal Shell",  "Cyber Shell" 
* DNS fix from previous release backed out because it's no longer needed. (We temporarily hardcoded an IP)

= 3.1.6 =
* Emergency release to deal with DNS issue.

= 3.1.4 =
* Fixed SQL error in code that checks if IP blockedTime has expired.  Changed column type to signed.
* Added detection of malicious injected titles with scripts or meta redirects.
* Fixed bug introduced in previous release that prevents blocked IP's from being blocked.

= 3.1.2 =
* Fixed permanent IP blocking bug which caused permanently blocked IP's to no longer display in the list after some time, even though there were still blocked. (Incorrect SQL query)
* Fixed "Can't get admin ID" on scan starts for both MU and single site installs.
* Improved status messages for sites with very large numbers of comments.
* Fixed bug that caused sites in subdirectories to not be able to view site config or run the memory test on the Wordfence "options" page.
* Fixed database disconnect bug (mysql server has gone away). An additional fix was required to finally squash this bug.
* Removed the code that prevented you from installing Wordfence on Windows. Sorry Windows customers!
* Improved scheduling so that it is now more reliable.
* Fixed bug that caused a loop for customers who could not contact the Wordfence servers on install.
* Added helpful message if you get the "can't connect to itself" error message with some additional documentation to help solve this issue.
* Improved error reporting when Wordfence can't connect to the scanning servers. Now features a helpful explanation rather than a generic message.
* Added Country Geo-Blocking feature for paid customers.
* Added Scan Scheduling feature for paid customers.

= 3.1.1 =
* Added another fix for "mysql server has gone away" error. Wordfence now makes sure the DB is still connected and reconnects if not.
* Added new detection for encoded malicious code in files.
* Fixed bug introduced yesterday that prevented permanent blocking of IP's.
* Improved ability to detect if we're running on Windows (but we don't support Windows yet).
* Issue intelligent warning if Wordfence can't read base WordPress directory.
* Don't activate Wordfence if user is running Windows.
* Cleaned up errors if a file can't be scanned due to permission restrictions.
* Improved reporting of which user scan is running as and how we determined who the admin user is.

= 3.1.0 =
* Changed the way we monitor disk space from % to warning on 20 megs and critical on 5 megs remaining. This deals with very large disks in a more rational way. (Thanks Yael M. and Ola A.)
* We now deal with cases where the $_SERVER variable contains an array instead of string for IP address. It seems that some installations modify the value into an array. (Thanks S.S.)
* The Wordfence DB connection now more reliably changes the mysql timeout for the session to prevent "mysql server has gone away" errors. (Thanks Peter A.) 

= 3.0.9 =
* Fixed problem where scan process can't get admin ID.
* Fixed issue that caused permanent IP's to not be permanent.
* Fixed SQL error when calculating if IP block has expired.
* Fixed incorrect calling of is_404 that caused intermittent issues.
* Fixed basedir warnings when scan tries to scan files it does not have access to.
* Fixed warning and incorrect calculation of rows in DB.
* Added ability to get IP from "HTTP_X_REAL_IP" header of a front-end proxy is sending it.
* Fixed warning about HTTPS element not existing in getRequestedURL()
* Fixed problem with paid vs free keys getting confused.
* Fixed error with fetching vulnerability patterns.

= 3.0.8 =
* Fixed bug that caused "Could not get the administrator’s user ID. Scan can’t continue."

= 3.0.7 =
* Fixed bug that caused scan to loop, stop halfway or not start for many sites.
* Fix bug that caused scan to not start on sites with thousands (over 20,000 in one case) users.
* Scan start is now faster for sites with large numbers of users.
* Fix bug that caused scan to get killed when checking passwords on sites with thousands of users.
* Wordfence now intelligently determines how to do a loopback request to kick off a scan.
* Scan is no longer called with a cron key in HTTP header but uses a query string value to authenticate itself which is more reliable. 

= 3.0.6 =
* Improved malware and phishing URL detection.
* Upgraded to Wordfence API version 1.9
* Fixed issue that caused large files to slow or crash a scan.
* Added workaround for PHP's broken filesize() function on 32 bit systems.
* Added an improved test mode for URL scanner for better unit testing on our end.
* Suppressed warnings issued when a reverse DNS lookup fails.
* Added improved debug output to becomeAdmin() function in scans to help diagnose scans not starting.

= 3.0.5 =
* Fixed "The key used to start a scan has expired." error and added data to help diagnose future issues like this.
* Removed HTTPHeaders from wfHits table which was using a lot of disk space and not used much.
* Removed limiting wfHits table size because it was unreliable.
* We're now limiting wfHits to 20,000 rows and the rows are much smaller. About 2 to 8 megs.
* Fixed bug that could have caused install routine to run repeatedly.
* Fixed typo bug in blocking code that didn't have any impact but was sloppy.
* Changed wfscan.php message when accessed directly to be more helpful.

= 3.0.4 =
* Detects if the Wordfence app (not scanner) is short on memory and requests more
* Fixes an issue where scan breaks if all scanning options are disabled

= 3.0.3 =
* Issue that caused all core files to show as missing has been fixed.
* We now handle all API server errors gracefully using exceptions.
* If your installation didn't activate correctly you now get a friendly message.
* Removed unused menu_config.php code.
* The 503 message now tells you why your access to the site has been limited so that admin's can tune firewall rules better.
* We no longer reuse the WordPress wpdb handle because we get better stability with our own connection.

= 3.0.2 =
* Overall this release is a very important upgrade. It drastically reduces memory usage on systems with large files from hundreds of megs to around 8 megs max memory used per scan.
* Moved queue of files that get processed to a new DB table to save memory.
* Reduced max size of tables before we truncate to avoid long DB queries.
* Reduced max size of wfStatus table from 100,000 rows to 1,000 rows.
* Introduced feature to kill hung or crashed scans reliably. 
* Made scan locking much more reliable to avoid multiple concurrent scans hogging resources.
* Debug status messages are no longer written to the DB in non-debug mode.
* Modified the list of unknown files we receive back from the WF scanning servers to be a packed string rather than an array which is more memory efficient.
* Added summary at the end of scans to show the peak memory that Wordfence used along with server peak memory.
* Hashes are now progressively sent to Wordfence servers during scan to drastically reduce memory usage.
* Upgraded to Wordfence server API version 1.8 
* List of hosts that Wordfence URL scanner compiles now uses wfArray which is a very memory efficient packed binary structure.
* Writes that WF URL scanner makes to the DB are now batched into bulk inserts to reduce load on DB.
* Fixed bug in wfscan.php (scanning script) that could have caused scans to loop or pick up old data.
* Massively reduced the number of status messages we log, but kept very verbose logging for debug mode with a warning about DB load.
* Added summary messages instead of individual file scanning status messages which show files scanned and scan rate.
* Removed bin2hex and hex2bin conversions for scanning data which were slow, memory heavy and unneeded.
* Wordfence database class will now reuse the WordPress database handle from $wpdb if it can to reduce DB connections.

= 2.1.5 =
* Fixed bug that caused WF to not work when certain DB caching plugins are used and override wpdb object.
* Fixed Wordfence so activity log only shows our own errors unless in debug mode.
* Wordfence now deletes all it's tables and deletes all saved options when you deactivate the plugin.
* Removed all exit() on error statements. Critical errors are handled more gracefully by writing to the log instead.
* Fixed a bug that would cause a database loop until running out of memory under certain error conditions.
* Suppressed useless warnings that occur in environments with basedir set or where functions are disabled for security reasons.
* Removed redundant check that executed on every request and put it in activation instead.
* If serialization during scan breaks, exit gracefully instead of looping.
* Disk space in log is now shown as Gigabytes and formatted nicely.
* Removed wdie() function which is a little obnoxious. Writing to WF error log instead.
* Fixed bug where a non-empty but useless HTTP header can break getIP() function.
* Added useful data to error output if getIP() tells you it can't work on your system. 
* Removed option to start scan in debug because it's no longer possible with a forked scan.
* Removed option to test process running time on a system because it breaks on most systems and confuses customers.
* Database connection errors no longer call die() but log an error instead in a way that removes the risk of a logging loop.
* Removed dropAll.php script because we now clean up tables on deactivate and it's not needed.
* Updated readme to show that we support 3.4. 

= 2.1.4 =
* Fixed registered users not appearing in live traffic.
* Fixed temp file deletion bug that caused warnings and loops.
* Fixed issue that caused warning about WORDFENCE_VERSION
* Fixed Wordfence admin area not working under SSL
* Fixed bug that caused IP addresses of clients to be misinterpreted if there are multiple addresses from chained proxies. 
* Now stripping port numbers from IP's which we weren't doing before.
* Added check for validity of IP's and report fatal error if it fails because this could lock users out.
* Improved error reporting including fixing an out of memory error when a specific error condition arose in wfConfig::set()
* Changed order of tmp dirs to be wordfence/lib protected dir first and then system temp dir. Added uploads as tmp dir for last resort.
* Malware URL's are now marked in red in alerts so it's obvious what the offending URL in a file is.

= 2.1.3 =
* Added fix for hosts that have max_allowed_packet set too small. We will write a temp file to disk instead if possible.
* Increased size of status column to 1000 chars

= 2.1.2 =
* Fixed issue with scan scheduling that caused a loop
* Fixed issue that caused version constant to not be included in scans

= 2.1.1 =
* Added ability to permanently block IP's
* Added ability to manually block IP's
* Made Wordfence more memory efficient, particularly the forking process.
* Fixed issue that caused WF to not work on databases with blank passwords.
* Wordfence now stops execution of a DB connection error is encountered.
* Clear cron jobs if Wordfence is uninstalled.
* Enabled hourly cron for Wordfence security network.
* Wordfence now works if your server doesn't have openssl installed
* Wordfence now works even if you don't have CURL
* Fixed visitor logging so it works with HTTPS websites.
* Alert emails now contain filenames in each alert description.
* Users with weak passwords alerts now contain the username in the email.
* Upgraded API to 1.7.
* Fixed issue that caused DISALLOW_FILE_MODS to make WF menu disappear.
* Modified wfDB to deal with very large queries without exceeding max_allowed_packet
* Fixed issue that broke ability to see file changes and repair files.

= 2.1.0 =
* Fixed scans hanging on Dreamhost and other hosts.
* Made Wordfence more memory efficient.
* Wordfence scans are now broken into steps so we can scan a huge number of files, posts and comments.
* Alert emails now include IP address, hostname lookup and geographic location (city if available).
* Improved scan locking. No longer time based but uses flock() if on unix or time on Windows.
* Suppressed warnings that WF was generating.
* Improve handling of non-standard wp-content directories.
* Fix restored files were still showing as changed if they contained international characters.
* Improve permission denied message if attempting to repair a file.
* Fixed problem that caused scans to not start because some hosts take too long to look up their own name.
* Fixed issue with Wordfence menu that caused it to not appear or conflict with other menus under certain conditions.
* Upgraded to API version 1.6
* Improved geo lookup code for IP's. 
* Fixed debug mode output in live status box - coloring was wrong.
* Added ajax status message to WF admin pages.
* Fixed colorbox popup so that it doesn't jump around on refresh.

= 2.0.7 =
* Fixed CSS bug that changed plugins page layout in admin area
* Added memory benchmark utility.
* Added process runtime benchmark utility.
* Added ability to scan in debug mode which accesses the scan app directly.

= 2.0.6 =
* Added IP whitelisting including ability to whitelist ranges that are excluded from firewall and login security measures.
* RFC1918 private networks and loopback address is automatically whitelisted to prevent firewall or login security blocking internal routers and proxy servers, internal firewalls and internal users.
* Added WORDFENCE_VERSION constant to improve version lookup performance.
* Fixed issue that caused security scans to not start and humans to not be logged in live traffic. Wordfence makes security scan script and visitors script executable on install or upgrade now.
* Fixed bug that caused disk space scanning to still show an issue found in security scan summary even when user chooses to ignore the security issue.
* Made disk space thresholds 1 and 1.5% space remaining because many hosts have very large disks where 1% is gigabytes.
* Made wordfence database handle cache deal with concurrent connections to different databases.
* Improved Wordfence database library's error reporting.
* Improved performance when Wordfence looks up it's own version during security scans and other operations.
* Removed three rules in base wordfence htaccess that could cause 500 errors on servers that don't allow these options to be overridden. Does not affect htaccess security because we inherit the base htaccess and still protect our lib/ directory with our own htaccess.

= 2.0.5 =
* If your plugin PHP files are viewable by the world, we now give you a detailed warning on the seriousness of this security threat with ability to view the offending .htaccess files.
* Added a debug mode in options for very verbose logging and marking errors in red.
* Added more logging for the process that starts the security scan.
* Ability to securely view the entire activity log added.
* Using plugin version in all CSS URL's instead of API version.
* Activity log microtime is more accurate now.
* Fixed bug that would cause security scanning of PHP files with base64 content to stop.

= 2.0.4 =
* Now security scanning all comments, posts and pages on multi-site installation for malware and phishing URL's.
* Improved messages on multisite when a bad comment or post is found.
* Fixed bug that caused paid users to not be able to activate their premium key.
* Made upgrade process much friendlier. 
* Got rid of GeSHi syntax highlighting because it segfaults and is resource intensive. Using built in PHP highlighting instead.
* Message asking you to configure an alert email address only appears for 3 pageviews after plugin activation so it's less irritating.
* Fixed bug for MU users that caused WF to tell you that your WF schema is missing and you need to reactivate. 
* Fixed bug that caused malware URL scanner to not work for MU users.

= 2.0.3 =
* Removed unbuffered queries and switched to conventional queries that are memory efficient for better stability.
* Made scanning large numbers of URL's contained in things like awstats log files extremely memory efficient and way faster.
* Removed alerts about unknown files in core directory if they belong to an older wordpress version and are unchanged.
* Other performance improvements like using strpos instead of strstr.
* Moved "scan files outside base dir" option to be in correct place on config page.

= 2.0.2 =
* Fixed plugin upgrades so that css and scripts are not cached across versions.

= 2.0.1 =
* Improved scanning for specific attacks being used in the PHP-CGI vulnerability ( CVE-2012-1823)
* API keys no longer required. WF fetches a temporary anonymous API key for you on activation.
* Added real-time activity log on scan page.
* Added real-time summary updates on scan page.
* Fixed ability to view files that have symlinks in path.
* Added message to configure alert email address for multi-site and single site installs on activation.
* Disabled firewall rules by default because most sites don't need them.
* Disabled blocking of fake googlebots except for high security levels to prevent users who like to pretend they're googlebot from blocking themselves.
* Geshi the syntax highlighter now asks for more memory before running.
* Fixed bug that caused scan to hang on very large files.
* Added an index to wfStatus to make it faster for summary statuses
* Removed multisite pre-activation check to make activation more reliable on multisite installs.
* Better problem reporting if you trashed your Wordfence schema but the plugin is still installed.

= 1.5.6 =
* Removed use of nonces and purely using 30 minute key for unlocking emails.
* Fixed bug that caused admin emails to not get emailed when requesting unlocking email.
* Fixed minor issue with undefined array in issues loop.

= 1.5.5 =
* Added ability for admin's to unlock login and unblock their IP addresses if they're accidentally locked out by the firewall or login security. Uses two security tokens to prevent abuse.
* Admins can now also disable firewall and login security from the unlock-me email, just in case of emergency.
* Made advanced options visible so you know they exist.
* Fixed dns_get_record() function not existing bug on Windows sytems pre PHP 5.3.0. Was causing scans to hang.
* Increased login lockout defaults to be much higher which still protects against brute force hacks.
* Removed CURLOPT_MAXREDIRS in curl to avoid safe mode warnings.
* Fixed ability to view and diff files on blogs installed in subdirectories.
* Fixed ability to see individual IP hits on subdir sites.
* Plugin and theme update messages now include links to the upgrade page.
* Removed the link on the login form that mentions the site is protected by Wordfence.
* Changed lockout defaults to be much higher.
* Added options for higher number of failures before lockout in options page.
* Now including plugin version in the activity log when the admin chooses to email it to us for debugging.

= 1.5.4 =
* Admin can now select to scan outside the WordPress base dir and standard WordPress directories.
* Max memory size for scans is now configurable for larger installations. 256M is the default.
* Changed maximum scan time to 10 minutes. 

= 1.5.3 =
* A harmless cosmetic error was being thrown up when some security scans started. Fixed that.

= 1.5.2 =
* Changed max scan time to 30 mins.

= 1.5.1 =
* Fixed a bug that caused scans to crash when permissions don't allow a directory to be read.

= 1.4.8 =
* WP repo didn't deploy the zip file correctly so recreating the version tag.

= 1.4.7 =
* Vastly improved error logging including catching fatal PHP errors and logging them to status log.
* Fixed accidental preg_replace variable interpolation.
* Syntax fixes (various)

= 1.4.6 =
* Increased memory available to Wordfence to 256M during security scans, configurable in wordfenceConstants.php
* Improved memory logging during security scans. Current memory usage is now shown on the far right of filenames while scans occur.

= 1.4.5 =
* Bugfix - fixed bug that caused Wordfence menu to dissapear.

= 1.4.4 =
* WordPress Multi-site support added. Currently in Beta. Tested with subdomains, not subdirectories, but it should work great on both.
* Main changes are moving menus to the Network Admin area, preventing individual blogs from enabling the plugin and dealing with database prefix issues.

= 1.4.3 =
* Improved diagnistic information on binary and regular API calls for better debugging.
* Changed ticker to only show activity with level < 3

= 1.4.2 =
* Email to send security alerts to is now configured at the same time an API key is entered.
* phpinfo is emailed along with activity log when user requests to send us activity log so that we can see things like PHP max execution time and other relevant data
* Now writing individual files to activity log during security scans for better diagnostics.
* Login security message.
* Updated readme.txt FAQ and description.
* Fixed bug where sites with self signed SSL security certificate never start scan because cert fails security check.
* Increased API curl timeout to 300 for slower hosts that seem affected during URL security scans.

= 1.4.1 =
* This is a major release, please upgrade immediately.
* Only scan files in the WordPress ABSPATH root directory and known WordPress subdirectories. Prevents potentially massive scans on hosts that have large dirs off their wordpress root.
* Don't generate plain SHA hashes anymore because we don't currently use them on the server side for scanning. (Still generates md5's and SHAC)
* No longer do change tracking on files before scans because the change tracking does almost the same amount of work when generating hashes as the actual scan. So just do the scan, which is now faster.
* Updated internal version to 1.2 to use new code on the server side which sends back a list of unknown files rather than known files, which is usually smaller and more network efficient.
* Improved logging in activity log.
* Removed SSL peer verification because some hosts have bad cert config. Connection to our servers is still via SSL. 
* Fixed a few minor issues. Overall you should notice that scans are much faster now.

= 1.3.3 =
* Made real-time server polling more efficient.
* Entering your API key now automatically starts your first scan. Was causing some confusion.
* Link to forums added for free customer support.

= 1.3.2 =
* Reduced the number of database connections that Wordfence makes to one.
* Modified the memory efficient unbuffered queries we use to only use a single DB connection.
* Removed status updates during post and comment scans which prevents interference with unbuffered queries and makes the scans even faster.

= 1.3.1 =
* Fixed a bug where if you have the plugin "secure-wordpress" installed, you can't do a Wordfence scan because it says you have the wrong version. This is because secure-wordpress trashes the $wp_version global variable to hide your version rather than using the filters provided by WordPress. So coded a workaround so that your Wordfence scans will work with that plugin installed.

= 1.3 =
* Minor fix to point to the correct binary API URL on the Wordfence cloud servers.

= 1.2 =
* It is now free to get a Wordfence API key.
* Premium keys include theme and plugin file verification which consumes resources on the Wordfence servers.
* Various bugfixes and performance enhancements.

= 1.1 =
* Initial public release of Wordfence.

== Upgrade Notice ==
= 3.1.1 =
Upgrade immediately. Fixes bug introduced in last release that broke permenent IP blocking.

= 3.0.9 =
Upgrade immediately. Fixes two critical bugs: Could not get admin ID bug and permanent IP blocks not staying permanent. 

= 3.0.6 =
Upgrade immediately. Improves malware URL detection by 20% or more.

= 3.0.3 =
Upgrade immediately. This release fixes an issue that caused Wordfence to show all your core files
missing under certain conditions. It was usually caused by high load on our scanning server and the
plugin not handling an error condition halfway through the scan correctly.

= 3.0.2 =
Upgrade immediately. This release drastically reduces memory, reduces new DB connections created by 
Wordfence to zero (we simply reuse the WordPress DB handle), reduces the number of DB queries to 
about 1% of the previous version by removing unneeded status messages and fixes a bug that 
could cause Wordfence to launch multiple concurrent scans that can put high load on your system.
This is a critical release. Upgrade immediately.
